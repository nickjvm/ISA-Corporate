/* Geolocator v.1.1 | Author: Onur Yildirim | https://github.com/onury/geolocator */
var geolocator=function(){function m(b,a,e){var c=document.createElement("script");c.type=void 0===e?"text/javascript":e;"function"===typeof a&&(c.readyState?c.onreadystatechange=function(){if("loaded"===c.readyState||"complete"===c.readyState)c.onreadystatechange=null,a()}:c.onload=function(){a()});c.src=b;document.getElementsByTagName("head")[0].appendChild(c)}function p(b){function a(){geolocator.__glcb&&delete geolocator.__glcb;google.load("maps","3",{other_params:"sensor=false",callback:b})}
void 0!==window.google&&void 0!==google.maps?b&&b():void 0!==window.google&&void 0!==google.loader?a():(geolocator.__glcb=a,m(t+"?callback=geolocator.__glcb"))}function u(b,a,e){var c,d,f;(b=document.getElementById(b))?(c=new google.maps.Map(b,a),d=new google.maps.Marker({position:a.center,map:c}),f=new google.maps.InfoWindow,f.setContent(e),google.maps.event.addListener(d,"click",function(){f.open(c,d)}),geolocator.location.map={canvas:b,map:c,options:a,marker:d,infoWindow:f}):geolocator.location.map=
null}function v(b,a){(new google.maps.Geocoder).geocode({latLng:b},function(b,c){c===google.maps.GeocoderStatus.OK&&a&&a(b)})}function q(b){var a=new google.maps.LatLng(b.latitude,b.longitude);v(a,function(b){if(0<b.length&&0<b.length){var c,d,f=b[0].address_components;geolocator.location.formattedAddress=b[0].formatted_address;for(c=0;c<f.length;c+=1)d=f[c],0<=d.types.indexOf("route")?geolocator.location.address.street=d.long_name:0<=d.types.indexOf("neighborhood")?geolocator.location.address.neighborhood=
d.long_name:0<=d.types.indexOf("sublocality")?geolocator.location.address.town=d.long_name:0<=d.types.indexOf("locality")?geolocator.location.address.city=d.long_name:0<=d.types.indexOf("administrative_area_level_1")?geolocator.location.address.region=d.long_name:0<=d.types.indexOf("country")?(geolocator.location.address.country=d.long_name,geolocator.location.address.countryCode=d.short_name):0<=d.types.indexOf("postal_code")?geolocator.location.address.postalCode=d.long_name:0<=d.types.indexOf("street_number")&&
(geolocator.location.address.streetNumber=d.long_name)}u(l,{zoom:null===geolocator.location.ipGeoSource?14:7,center:a,mapTypeId:"roadmap"},b[0].formatted_address);h&&h.call(null,geolocator.location)})}function w(b,a){function e(a){var c=!0===b?0:"number"===typeof b?b:-1;0<=c?geolocator.locateByIP(h,g,c,l):g&&g.call(null,a)}function c(a){geolocator.location={ipGeoSource:null,coords:a.coords,timestamp:(new Date).getTime(),address:{}};q(geolocator.location.coords)}function d(a){e(a.message)}geolocator.location=
null;navigator.geolocation?navigator.geolocation.getCurrentPosition(c,d,a):e("geolocation is not supported.")}function r(b,a){switch(b){case 0:geolocator.location={coords:{latitude:a.latitude,longitude:a.longitude},address:{city:a.city,country:a.country_name,countryCode:a.country_code,region:a.region_name}};break;case 1:geolocator.location={coords:{latitude:a.geoplugin_latitude,longitude:a.geoplugin_longitude},address:{city:a.geoplugin_city,country:a.geoplugin_countryName,countryCode:a.geoplugin_countryCode,
region:a.geoplugin_regionName}};break;case 2:geolocator.location={coords:{latitude:a.lat,longitude:a.lon},address:{city:a.city,country:"",countryCode:a.country,region:""}}}geolocator.location&&(geolocator.location.coords.accuracy=null,geolocator.location.coords.altitude=null,geolocator.location.coords.altitudeAccuracy=null,geolocator.location.coords.heading=null,geolocator.location.coords.speed=null,geolocator.location.timestamp=(new Date).getTime(),geolocator.location.ipGeoSource=n[b],geolocator.location.ipGeoSource.data=
a)}function s(b){var a=!1;geolocator.location=null;delete geolocator.__ipscb;p(function(){2===k?void 0!==window.Geo&&(r(k,window.Geo),delete window.Geo,a=!0):void 0!==b&&(r(k,b),a=!0);!0===a?q(geolocator.location.coords):g&&g("Could not get location.")})}var h,g,l,t="https://www.google.com/jsapi",n=[{url:"http://freegeoip.net/json/",cbParam:"callback"},{url:"http://www.geoplugin.net/json.gp",cbParam:"jsoncallback"},{url:"http://geoiplookup.wikimedia.org/",cbParam:""}],k=0;return{location:null,locate:function(b,
a,e,c,d){h=b;g=a;l=d;p(function(){w(e,c)})},locateByIP:function(b,a,e,c){k=void 0===e||0>e||e>=n.length?0:e;h=b;g=a;l=c;geolocator.__ipscb=s;b=n[k];void 0===b.cbParam||null===b.cbParam||""===b.cbParam?m(b.url,s):m(b.url+"?"+b.cbParam+"=geolocator.__ipscb")}}}();
